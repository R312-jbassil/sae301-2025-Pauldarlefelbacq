---
import boisTexture from '../assets/textures/bois.avif';
import carboneTexture from '../assets/textures/carbone.avif';
import orTexture from '../assets/textures/or.avif';

interface Props {
  montureColor?: string;
  brancheColor?: string;
  strokeColor?: string;
  verresColor?: string;
  className?: string;
}

const { 
  montureColor = '#ffffff', 
  brancheColor = '#ffffff',
  strokeColor = '#1D1D1B',
  verresColor = 'transparent',
  className = ''
} = Astro.props;
---

<svg 
  class={`customizable-glasses ${className}`}
  width="1001" 
  height="386" 
  viewBox="0 0 1001 386" 
  fill="none" 
  xmlns="http://www.w3.org/2000/svg"
  data-monture-color={montureColor}
  data-branche-color={brancheColor}
  data-stroke-color={strokeColor}
  data-verres-color={verresColor}
>
  <defs>
    <pattern id="texture-bois" patternUnits="objectBoundingBox" width="1" height="1">
      <image href={boisTexture.src} x="0" y="0" width="100%" height="100%" preserveAspectRatio="xMidYMid slice"/>
    </pattern>
    <pattern id="texture-carbone" patternUnits="objectBoundingBox" width="1" height="1">
      <image href={carboneTexture.src} x="0" y="0" width="100%" height="100%" preserveAspectRatio="xMidYMid slice"/>
    </pattern>
    <pattern id="texture-or" patternUnits="objectBoundingBox" width="1" height="1">
      <image href={orTexture.src} x="0" y="0" width="100%" height="100%" preserveAspectRatio="xMidYMid slice"/>
    </pattern>
  </defs>

  <style>
    .customizable-glasses .branche {
      fill: var(--branche-fill, var(--branche-color, #ffffff));
      stroke: var(--stroke-color, #1D1D1B);
      transition: fill 0.3s ease;
    }
    .customizable-glasses .monture {
      fill: var(--monture-fill, var(--monture-color, #ffffff));
      stroke: var(--stroke-color, #1D1D1B);
      transition: fill 0.3s ease;
    }
    .customizable-glasses .verres {
      fill: var(--verres-color, transparent);
      opacity: 0.7;
      transition: fill 0.3s ease;
    }
  </style>
  
  <ellipse class="verres" cx="150" cy="210" rx="90" ry="100"/>
  <ellipse class="verres" cx="530" cy="240" rx="100" ry="110"/>
  
  <path class="branche" d="M14.0874 106.161C14.0874 106.161 135.889 92.4076 149.661 84.5309C163.433 76.6541 177.156 64.876 197.79 60.95C218.423 57.0239 356.934 33.443 356.934 33.443C356.934 33.443 374.606 28.5293 400.151 47.1965C425.696 65.8637 481.698 125.816 497.395 123.865C513.117 121.89 520.966 100.284 516.054 90.4569C511.142 80.6295 415.675 9.59051 399.164 4.94841C375.643 -1.66906 345.137 -0.95299 307.794 4.94841C270.476 10.8498 20.9488 62.5796 20.9488 62.5796C20.9488 62.5796 -11.4577 77.6911 14.0627 106.186L14.0874 106.161Z" stroke-width="0.5" stroke-miterlimit="10"/>
  <g style="mix-blend-mode:multiply">
    <path d="M506.256 95.346C506.256 95.346 505.49 110.532 496.432 109.099C484.166 107.173 408.024 25.5663 382.479 29.4923C382.479 29.4923 403.532 36.1838 428.041 58.2338C444.108 72.7034 512.993 151.693 506.256 95.346Z" fill="#706F6F"/>
  </g>
  <path class="branche" d="M670.509 166.681L893.973 93.1484C893.973 93.1484 948.592 79.2468 956.54 83.2222C964.487 87.1976 1000.25 158.73 1000.25 166.681C1000.25 174.632 994.277 201.275 986.355 203.448C980.604 205.028 973.2 203.719 969.473 193.052C965.993 183.126 952.591 114.705 938.695 115.347C924.8 115.989 813.561 154.73 813.561 154.73C813.561 154.73 780.785 170.632 766.889 182.558C752.994 194.485 687.44 210.386 687.44 210.386C687.44 210.386 663.598 191.497 670.558 166.657L670.509 166.681Z" stroke-width="0.5" stroke-miterlimit="10"/>
  <g style="mix-blend-mode:multiply">
    <path d="M686.675 167.792C686.675 167.792 939.09 80.9011 952.862 88.8026C952.862 88.8026 907.942 94.9509 849.793 118.137C791.644 141.323 686.675 172.533 686.675 172.533V167.792Z" fill="#706F6F"/>
  </g>
  <g style="mix-blend-mode:multiply">
    <path d="M943.409 113.371C943.409 113.371 951.455 113.371 955.7 121.89C959.946 130.409 979.814 182.904 979.814 182.904C979.814 182.904 981.714 195.201 992.574 176.286C992.574 176.286 984.997 199.892 979.345 193.052C973.693 186.213 955.232 128.038 955.232 128.038C955.232 128.038 948.148 111.396 943.409 113.371Z" fill="#706F6F"/>
  </g>
  <path class="monture" d="M696.474 169.546C695.881 161.126 672.854 156.656 665.104 153.743C657.354 150.829 626.354 158.582 626.354 158.582C596.317 150.829 491.718 136.285 431.669 136.285C371.619 136.285 351.282 164.385 344.495 163.422C337.708 162.459 301.87 161.496 286.371 158.582C270.871 155.669 273.783 123.692 189.497 93.1978C105.235 62.7031 20.9488 62.5302 20.9488 62.5302C-12.0006 74.0367 4.26428 108.186 4.26428 108.186L9.32394 123.865C19.9862 128.878 17.0738 149.841 20.9488 180.854C24.8237 211.868 39.361 251.597 55.8233 275.82C72.2857 300.043 134.285 327.18 165.285 328.143C196.284 329.105 223.409 323.303 243.746 290.339C264.083 257.4 285.408 199.25 285.408 199.25L310.583 203.127C310.583 203.127 317.765 203.892 323.787 210.757C329.81 217.621 334.721 230.584 342.545 253.498C361.204 308.068 404.544 350.415 404.544 350.415C404.544 350.415 418.366 368.761 487.078 381.675C544.042 392.391 592.467 375.601 592.467 375.601C636.202 357.896 645.852 264.585 645.852 264.585C645.852 264.585 650.369 231.745 665.128 223.473C683.319 213.25 685.54 212.51 696.498 210.337C705.408 208.584 697.091 177.916 696.498 169.496L696.474 169.546ZM215.659 294.265C192.409 306.858 136.235 311.698 101.36 284.586C66.4856 257.449 50.0233 209.966 45.1857 153.767C40.3482 97.5682 62.7094 91.4693 62.7094 91.4693C62.7094 91.4693 99.4351 89.8149 146.897 101.42C194.359 113.05 246.659 145.989 247.646 167.323C248.608 188.633 238.933 281.672 215.684 294.265H215.659ZM596.317 354.341C574.03 365.008 543.327 365.971 517.51 364.02C491.694 362.094 424.857 360.143 400.645 286.487C400.645 286.487 393.857 251.597 388.057 243.844C382.257 236.091 364.807 208.09 364.807 198.336C364.807 178.015 382.455 166.311 382.455 166.311C382.455 166.311 402.594 153.718 428.732 153.718C454.894 153.718 588.543 160.508 606.955 185.694C625.367 210.88 624.38 239.967 627.292 263.227C630.205 286.487 618.58 343.649 596.293 354.316L596.317 354.341Z" stroke-width="0.5" stroke-miterlimit="10"/>
</svg>

<script define:vars={{ montureColor, brancheColor, strokeColor, verresColor }}>
  const svg = document.querySelector('.customizable-glasses');
  if (svg) {
    svg.style.setProperty('--monture-color', montureColor);
    svg.style.setProperty('--branche-color', brancheColor);
    svg.style.setProperty('--stroke-color', strokeColor);
    svg.style.setProperty('--verres-color', verresColor);
  }
</script>
